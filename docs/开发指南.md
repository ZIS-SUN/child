# 幼儿园信息管理系统 - 开发指南

## 快速开始

### 方式一：使用启动脚本（推荐）

```bash
# 1. 启动后端（新终端窗口）
./start-backend.sh

# 2. 启动前端（新终端窗口）
./start-frontend.sh
```

### 方式二：手动启动

**后端**
```bash
cd backend
mvn spring-boot:run
```

**前端**
```bash
cd frontend
npm run dev
```

## 测试账号

系统已预置以下测试账号（密码均为 `admin123`）:

| 角色 | 用户名 | 密码 | 说明 |
|------|--------|------|------|
| 园长 | admin | admin123 | 拥有全部权限 |
| 教师 | teacher1 | admin123 | 管理班级和幼儿 |
| 家长 | parent1 | admin123 | 查看孩子信息 |

## 已完成功能

### ✅ 后端功能
1. 数据库设计（16张表）
2. Spring Boot项目架构
3. Spring Security + JWT认证
4. MyBatis Plus集成
5. Knife4j接口文档
6. 用户登录/注册API
7. BCrypt密码加密
8. CORS跨域配置

### ✅ 前端功能
1. Vue3 + Vite项目架构
2. Vue Router路由配置
3. Pinia状态管理
4. Element Plus UI组件库
5. Axios请求封装
6. JWT Token管理
7. 登录/注册页面
8. 家长端布局和首页
9. 管理员端布局和数据面板

## 待开发功能

### 后端API开发

参考 `prd.md` 中的API清单，需要实现以下接口：

**家长端**
- [ ] 首页数据接口
- [ ] 孩子信息接口
- [ ] 考勤查询接口
- [ ] 请假申请/查询接口
- [ ] 通知公告接口
- [ ] 成长相册接口
- [ ] 健康信息接口
- [ ] 意见反馈接口
- [ ] 消息中心接口

**管理员端**
- [ ] 数据面板统计接口
- [ ] 用户管理CRUD接口
- [ ] 幼儿管理CRUD接口
- [ ] 班级管理接口
- [ ] 考勤管理接口
- [ ] 请假审批接口
- [ ] 通知发布接口
- [ ] 相册管理接口
- [ ] 反馈处理接口

### 前端页面开发

**家长端**
- [ ] 完善首页数据展示
- [ ] 孩子信息详情页
- [ ] 考勤日历组件
- [ ] 请假申请表单
- [ ] 请假记录列表
- [ ] 通知公告列表和详情
- [ ] 相册浏览组件
- [ ] 个人中心表单

**管理员端**
- [ ] 数据面板图表
- [ ] 用户管理表格和表单
- [ ] 幼儿管理表格和表单
- [ ] 班级管理界面
- [ ] 考勤登记界面
- [ ] 请假审批界面
- [ ] 通知发布富文本编辑器
- [ ] 相册上传组件

## 开发规范

### 后端开发

**1. Controller层**
```java
@Api(tags = "模块名称")
@RestController
@RequestMapping("/模块路径")
public class XxxController {

    @Autowired
    private XxxService xxxService;

    @ApiOperation("接口说明")
    @PostMapping("/xxx")
    public Result<Xxx> xxx(@RequestBody XxxDTO dto) {
        return Result.success(xxxService.xxx(dto));
    }
}
```

**2. Service层**
```java
@Service
public class XxxService {

    @Autowired
    private XxxMapper xxxMapper;

    @Transactional(rollbackFor = Exception.class)
    public void xxx(XxxDTO dto) {
        // 业务逻辑
    }
}
```

**3. 异常处理**
- 业务异常抛出 RuntimeException
- 使用 @Valid 进行参数校验
- 统一在Controller返回Result对象

### 前端开发

**1. API封装**
```javascript
// src/api/xxx.js
import request from '@/utils/request'

export function getXxx(params) {
  return request({
    url: '/xxx',
    method: 'get',
    params
  })
}
```

**2. 页面组件**
```vue
<template>
  <div class="container">
    <!-- 页面内容 -->
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'

const data = ref([])

onMounted(() => {
  // 初始化数据
})
</script>

<style scoped>
.container {
  padding: 20px;
}
</style>
```

**3. 状态管理**
- 用户信息存储在 `useUserStore`
- Token存储在 localStorage
- 需要共享的状态使用Pinia

## 接口文档

启动后端后访问：http://localhost:8080/api/doc.html

Knife4j提供以下功能：
- 接口在线测试
- 参数说明
- 响应示例
- 模型定义

## 数据库操作

### 查看数据
```bash
mysql -u root -p1234 -e "USE ultrathink; SELECT * FROM sys_user;"
```

### 重置数据库
```bash
mysql -u root -p1234 -e "DROP DATABASE ultrathink;"
mysql -u root -p1234 < docs/database.sql
```

### 添加测试数据
```sql
-- 添加更多测试幼儿
INSERT INTO child_info (name, gender, birth_date, class_id, enrollment_date, status)
VALUES ('张三', 'M', '2020-03-15', 1, '2023-09-01', 1);

-- 添加请假记录
INSERT INTO leave_request (child_id, parent_id, leave_type, start_date, end_date, reason, status)
VALUES (1, 1, 'SICK', '2024-01-20', '2024-01-22', '感冒发烧', 'PENDING');
```

## 常见问题

### 1. 后端启动失败

**问题**: 数据库连接失败
```
Error creating bean with name 'dataSource'
```

**解决**:
- 检查MySQL是否启动
- 确认数据库用户名密码正确
- 确认数据库 `ultrathink` 已创建

### 2. 前端请求失败

**问题**: CORS跨域错误
```
Access to XMLHttpRequest has been blocked by CORS policy
```

**解决**:
- 确认后端已启动
- 检查 `SecurityConfig` 中的CORS配置
- 确认前端请求地址正确

### 3. JWT Token过期

**问题**: 401 Unauthorized

**解决**:
- 重新登录获取新Token
- 检查Token是否正确存储
- 确认请求头携带 `Authorization: Bearer <token>`

### 4. Maven编译失败

**问题**: 依赖下载失败

**解决**:
```bash
# 清理Maven缓存
mvn clean
rm -rf ~/.m2/repository

# 重新下载
mvn clean install
```

## 下一步开发建议

### 优先级1：核心业务功能
1. 完善用户管理接口
2. 实现幼儿档案CRUD
3. 实现班级管理功能
4. 完成通知公告模块

### 优先级2：特色功能
1. 考勤管理和统计
2. 请假申请和审批流程
3. 成长相册上传和浏览
4. 家园互动消息

### 优先级3：增强功能
1. 文件上传（头像、相册）
2. Excel导入导出
3. 数据可视化图表
4. 操作日志记录

## 技术支持

- PRD文档: `prd.md`
- 数据库脚本: `docs/database.sql`
- API文档: http://localhost:8080/api/doc.html
- 前端源码: `frontend/src/`
- 后端源码: `backend/src/main/java/`

---

**祝开发顺利！** 🎉
